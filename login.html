<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Academy - Portal Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Montserrat', sans-serif;
        }
        
        .font-lato {
            font-family: 'Lato', sans-serif;
        }
        
        /* Custom animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(253, 186, 116, 0.5); }
            50% { box-shadow: 0 0 20px rgba(253, 186, 116, 0.8), 0 0 30px rgba(253, 186, 116, 0.6); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        .glow-animation {
            animation: glow 2s ease-in-out infinite;
        }
        
        .slide-in {
            animation: slideIn 0.6s ease-out forwards;
        }
        
        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        
        /* Gradient backgrounds */
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #60a5fa 100%);
        }
        
        .card-shadow {
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        /* Dark mode styles */
        .dark .gradient-bg {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Accessibility features */
        .text-enlarge-sm { font-size: 1.1em; }
        .text-enlarge-md { font-size: 1.3em; }
        .text-enlarge-lg { font-size: 1.5em; }
        
        /* Five-star menu animation */
        .star-menu {
            position: relative;
            overflow: hidden;
        }
        
        .star-menu::before {
            content: "★★★★★";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(253, 186, 116, 0.3), transparent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            color: #fbbf24;
            transition: left 0.6s ease;
        }
        
        .star-menu:hover::before {
            left: 100%;
        }
        
        /* Tab styles */
        .tab-active {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
        }
        
        .tab-inactive {
            background: #f3f4f6;
            color: #6b7280;
        }
        
        .dark .tab-inactive {
            background: #374151;
            color: #9ca3af;
        }
        
        /* Modal styles */
        .modal-overlay {
            backdrop-filter: blur(4px);
        }
        
        /* Grade color coding */
        .grade-a { color: #059669; font-weight: bold; }
        .grade-b { color: #0284c7; font-weight: bold; }
        .grade-c { color: #d97706; font-weight: bold; }
        .grade-d { color: #dc2626; font-weight: bold; }
        .grade-f { color: #991b1b; font-weight: bold; }
        
        /* Progress bar styles */
        .progress-bar {
            background: linear-gradient(90deg, #10b981, #34d399);
            border-radius: 9999px;
            height: 8px;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="min-h-screen transition-colors duration-300">
    <!-- Accessibility Panel -->
    <div id="accessibilityPanel" class="fixed top-4 right-4 z-50 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-lg hidden">
        <h3 class="font-semibold mb-3 text-gray-800 dark:text-white">Accessibility</h3>
        <div class="space-y-2">
            <button onclick="toggleDarkMode()" class="w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">🌙 Dark Mode</button>
            <button onclick="changeTextSize('sm')" class="w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">🔤 Small Text</button>
            <button onclick="changeTextSize('md')" class="w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">🔤 Medium Text</button>
            <button onclick="changeTextSize('lg')" class="w-full text-left p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">🔤 Large Text</button>
        </div>
    </div>
    
    <!-- Accessibility Toggle Button -->
    <button onclick="toggleAccessibility()" class="fixed top-4 right-4 z-40 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-colors">
        <i data-lucide="accessibility" class="w-5 h-5"></i>
    </button>

    <!-- AI Assistant -->
    <div id="aiAssistant" class="fixed bottom-6 right-6 z-50">
        <button onclick="toggleAI()" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 glow-animation">
            <i data-lucide="message-circle" class="w-6 h-6"></i>
        </button>
        <div id="aiChat" class="hidden absolute bottom-16 right-0 w-80 h-96 bg-white dark:bg-gray-800 rounded-lg shadow-2xl border">
            <div class="p-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-t-lg">
                <h3 class="font-semibold">Elite Academy Assistant</h3>
            </div>
            <div id="chatMessages" class="h-64 overflow-y-auto p-4 space-y-2">
                <div class="bg-blue-100 dark:bg-blue-900 p-2 rounded">
                    Hello! I'm here to help you navigate Elite Academy's portal. How can I assist you today?
                </div>
            </div>
            <div class="p-4 border-t">
                <div class="flex space-x-2">
                    <input type="text" id="chatInput" placeholder="Type your message..." class="flex-1 p-2 border rounded text-base">
                    <button onclick="sendMessage()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Container -->
    <div class="min-h-screen gradient-bg flex items-center justify-center p-4">
        
        <!-- Portal Selection Screen -->
        <div id="portalSelection" class="slide-in">
            <div class="text-center mb-8">
                <div class="float-animation mb-6">
                    <div class="w-24 h-24 bg-white rounded-full flex items-center justify-center mx-auto shadow-2xl">
                        <span class="text-3xl font-bold text-blue-600">EA</span>
                    </div>
                </div>
                <h1 class="text-4xl font-bold text-white mb-4">Elite Academy</h1>
                <p class="text-blue-100 text-lg font-lato">Empowering Learners, Connecting Teachers, Building the Future</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl">
                <!-- Admin Portal -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow hover:scale-105 transition-all duration-300 cursor-pointer star-menu" onclick="showLogin('admin')">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="shield-check" class="w-8 h-8 text-red-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-2">Admin Portal</h3>
                        <p class="text-gray-600 dark:text-gray-300 font-lato">Administrative access and student management</p>
                        <div class="mt-4 text-sm text-red-600 font-medium">Authorized Personnel Only</div>
                    </div>
                </div>
                
                <!-- Student Portal -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow hover:scale-105 transition-all duration-300 cursor-pointer star-menu" onclick="showLogin('student')">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="graduation-cap" class="w-8 h-8 text-blue-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-2">Student Portal</h3>
                        <p class="text-gray-600 dark:text-gray-300 font-lato">Access grades, assignments, and resources</p>
                        <div class="mt-4 text-sm text-blue-600 font-medium">Students Access Here</div>
                    </div>
                </div>
                
                <!-- Parent Portal -->
                <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow hover:scale-105 transition-all duration-300 cursor-pointer star-menu" onclick="showLogin('parent')">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i data-lucide="users" class="w-8 h-8 text-green-600"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-2">Parent Portal</h3>
                        <p class="text-gray-600 dark:text-gray-300 font-lato">Monitor your child's progress and communication</p>
                        <div class="mt-4 text-sm text-green-600 font-medium">Parents & Guardians</div>
                    </div>
                </div>
            </div>

            <!-- Quick Access Cards -->
            <div class="mt-12 text-center">
                <h3 class="text-white text-lg font-semibold mb-4">Quick Access Codes</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl mx-auto">
                    <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4">
                        <h4 class="text-white font-medium mb-2">Sample Student Login</h4>
                        <p class="text-blue-100 text-sm">ID: EA001 | Code: JS2024</p>
                        <p class="text-blue-100 text-sm">ID: EA002 | Code: SJ2024</p>
                    </div>
                    <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4">
                        <h4 class="text-white font-medium mb-2">Admin Access</h4>
                        <p class="text-blue-100 text-sm">Authorized Personnel</p>
                        <p class="text-blue-100 text-sm">Contact IT for Support</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Login Form -->
        <div id="adminLogin" class="hidden slide-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow max-w-md w-full">
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-lucide="shield-check" class="w-8 h-8 text-red-600"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Admin Login</h2>
                    <p class="text-gray-600 dark:text-gray-300 font-lato">Secure administrative access</p>
                </div>
                
                <form onsubmit="adminLogin(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email Address</label>
                            <input type="email" id="adminEmail" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 dark:bg-gray-700 dark:text-white text-base" placeholder="admin@eliteacademy.edu">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Master Password</label>
                            <input type="password" id="adminPassword" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 dark:bg-gray-700 dark:text-white text-base" placeholder="Enter master password">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Security Code</label>
                            <input type="text" id="adminCode" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 dark:bg-gray-700 dark:text-white text-base" placeholder="EA-ADMIN-2024">
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full mt-6 bg-gradient-to-r from-red-600 to-red-700 text-white p-3 rounded-lg hover:from-red-700 hover:to-red-800 transition-all duration-300 font-semibold">
                        Access Admin Dashboard
                    </button>
                </form>
                
                <button onclick="goBack()" class="w-full mt-4 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors">
                    ← Back to Portal Selection
                </button>
            </div>
        </div>

        <!-- Student Login Form -->
        <div id="studentLogin" class="hidden slide-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow max-w-md w-full">
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-lucide="graduation-cap" class="w-8 h-8 text-blue-600"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Student Login</h2>
                    <p class="text-gray-600 dark:text-gray-300 font-lato">Access your learning dashboard</p>
                </div>
                
                <form onsubmit="studentLogin(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Student ID</label>
                            <input type="text" id="studentId" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-base" placeholder="Enter your student ID (e.g., EA001)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Access Code</label>
                            <input type="password" id="studentCode" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white text-base" placeholder="Enter access code (e.g., JS2024)">
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg">
                        <p class="text-sm text-blue-800 dark:text-blue-200 font-medium">Demo Credentials:</p>
                        <p class="text-xs text-blue-600 dark:text-blue-300">ID: EA001 | Code: JS2024</p>
                        <p class="text-xs text-blue-600 dark:text-blue-300">ID: EA002 | Code: SJ2024</p>
                    </div>
                    
                    <button type="submit" class="w-full mt-6 bg-gradient-to-r from-blue-600 to-blue-700 text-white p-3 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-semibold">
                        Access Student Dashboard
                    </button>
                </form>
                
                <div class="mt-4 text-center">
                    <p class="text-sm text-gray-600 dark:text-gray-400">Forgot your access code? Contact your teacher or admin.</p>
                </div>
                
                <button onclick="goBack()" class="w-full mt-4 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors">
                    ← Back to Portal Selection
                </button>
            </div>
        </div>

        <!-- Parent Login Form -->
        <div id="parentLogin" class="hidden slide-in">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow max-w-md w-full">
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-lucide="users" class="w-8 h-8 text-green-600"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Parent Login</h2>
                    <p class="text-gray-600 dark:text-gray-300 font-lato">Monitor your child's progress</p>
                </div>
                
                <form onsubmit="parentLogin(event)">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email Address</label>
                            <input type="email" id="parentEmail" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-700 dark:text-white text-base" placeholder="Enter your email">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Password</label>
                            <input type="password" id="parentPassword" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-700 dark:text-white text-base" placeholder="Enter password">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Child's Student ID</label>
                            <input type="text" id="childId" required class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 dark:bg-gray-700 dark:text-white text-base" placeholder="Enter child's student ID">
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full mt-6 bg-gradient-to-r from-green-600 to-green-700 text-white p-3 rounded-lg hover:from-green-700 hover:to-green-800 transition-all duration-300 font-semibold">
                        Access Parent Dashboard
                    </button>
                </form>
                
                <button onclick="goBack()" class="w-full mt-4 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors">
                    ← Back to Portal Selection
                </button>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="hidden w-full max-w-7xl">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800 dark:text-white">Admin Dashboard</h1>
                        <p class="text-gray-600 dark:text-gray-300 font-lato">Comprehensive Student Management System</p>
                    </div>
                    <button onclick="logout()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors">
                        Logout
                    </button>
                </div>
                
                <!-- Admin Statistics -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-blue-50 dark:bg-blue-900 p-6 rounded-lg">
                        <h3 class="font-semibold text-blue-800 dark:text-blue-200 mb-2">Total Students</h3>
                        <p class="text-3xl font-bold text-blue-600" id="totalStudents">0</p>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900 p-6 rounded-lg">
                        <h3 class="font-semibold text-green-800 dark:text-green-200 mb-2">Average GPA</h3>
                        <p class="text-3xl font-bold text-green-600" id="averageGPA">0.0</p>
                    </div>
                    <div class="bg-yellow-50 dark:bg-yellow-900 p-6 rounded-lg">
                        <h3 class="font-semibold text-yellow-800 dark:text-yellow-200 mb-2">Active Assignments</h3>
                        <p class="text-3xl font-bold text-yellow-600" id="activeAssignments">0</p>
                    </div>
                    <div class="bg-purple-50 dark:bg-purple-900 p-6 rounded-lg">
                        <h3 class="font-semibold text-purple-800 dark:text-purple-200 mb-2">Total Subjects</h3>
                        <p class="text-3xl font-bold text-purple-600" id="totalSubjects">0</p>
                    </div>
                </div>
                
                <!-- Admin Tabs -->
                <div class="flex flex-wrap gap-2 mb-8 border-b border-gray-200 dark:border-gray-600">
                    <button onclick="switchTab('students')" id="tab-students" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-active">
                        Students
                    </button>
                    <button onclick="switchTab('grades')" id="tab-grades" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-inactive">
                        Grades & Scores
                    </button>
                    <button onclick="switchTab('assignments')" id="tab-assignments" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-inactive">
                        Assignments
                    </button>
                    <button onclick="switchTab('attendance')" id="tab-attendance" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-inactive">
                        Attendance
                    </button>
                    <button onclick="switchTab('achievements')" id="tab-achievements" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-inactive">
                        Achievements
                    </button>
                </div>

                <!-- Students Tab -->
                <div id="content-students" class="tab-content">
                    <!-- Add New Student -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Add New Student</h3>
                        <form onsubmit="addStudent(event)" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <input type="text" id="newStudentName" placeholder="Full Name" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <input type="email" id="newStudentEmail" placeholder="Email" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <input type="text" id="newStudentClass" placeholder="Class/Grade" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <button type="submit" class="bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold">
                                Add Student
                            </button>
                        </form>
                    </div>
                    
                    <!-- Students List -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Student Management</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-gray-300 dark:border-gray-600">
                                        <th class="text-left p-3 text-gray-700 dark:text-gray-300">Student ID</th>
                                        <th class="text-left p-3 text-gray-700 dark:text-gray-300">Name</th>
                                        <th class="text-left p-3 text-gray-700 dark:text-gray-300">Email</th>
                                        <th class="text-left p-3 text-gray-700 dark:text-gray-300">Class</th>
                                        <th class="text-left p-3 text-gray-700 dark:text-gray-300">GPA</th>
                                        <th class="text-left p-3 text-gray-700 dark:text-gray-300">Rank</th>
                                        <th class="text-left p-3 text-gray-700 dark:text-gray-300">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="studentsTable">
                                    <!-- Students will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Grades & Scores Tab -->
                <div id="content-grades" class="tab-content hidden">
                    <!-- Add Grade Form -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Add Subject Grade</h3>
                        <form onsubmit="addGrade(event)" class="grid grid-cols-1 md:grid-cols-5 gap-4">
                            <select id="gradeStudentId" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="">Select Student</option>
                            </select>
                            <input type="text" id="gradeSubject" placeholder="Subject" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <select id="gradeValue" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="">Select Grade</option>
                                <option value="A+">A+ (4.0)</option>
                                <option value="A">A (4.0)</option>
                                <option value="A-">A- (3.7)</option>
                                <option value="B+">B+ (3.3)</option>
                                <option value="B">B (3.0)</option>
                                <option value="B-">B- (2.7)</option>
                                <option value="C+">C+ (2.3)</option>
                                <option value="C">C (2.0)</option>
                                <option value="C-">C- (1.7)</option>
                                <option value="D">D (1.0)</option>
                                <option value="F">F (0.0)</option>
                            </select>
                            <input type="number" id="gradePoints" placeholder="Points (0-100)" min="0" max="100" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <button type="submit" class="bg-green-600 text-white p-3 rounded-lg hover:bg-green-700 transition-colors font-semibold">
                                Add Grade
                            </button>
                        </form>
                    </div>
                    
                    <!-- Grades Overview -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Recent Grades</h3>
                        <div id="gradesOverview" class="space-y-4">
                            <!-- Grades will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Assignments Tab -->
                <div id="content-assignments" class="tab-content hidden">
                    <!-- Add Assignment Form -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Create Assignment</h3>
                        <form onsubmit="addAssignment(event)" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                            <input type="text" id="assignmentTitle" placeholder="Assignment Title" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <input type="text" id="assignmentSubject" placeholder="Subject" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <input type="date" id="assignmentDue" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <input type="number" id="assignmentMaxPoints" placeholder="Max Points" min="0" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <button type="submit" class="bg-purple-600 text-white p-3 rounded-lg hover:bg-purple-700 transition-colors font-semibold">
                                Create Assignment
                            </button>
                        </form>
                    </div>
                    
                    <!-- Grade Assignment -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Grade Assignment</h3>
                        <form onsubmit="gradeAssignment(event)" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                            <select id="assignmentStudentId" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="">Select Student</option>
                            </select>
                            <select id="assignmentSelect" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="">Select Assignment</option>
                            </select>
                            <input type="number" id="assignmentScore" placeholder="Score" min="0" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <select id="assignmentStatus" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="completed">Completed</option>
                                <option value="late">Late</option>
                                <option value="pending">Pending</option>
                            </select>
                            <button type="submit" class="bg-orange-600 text-white p-3 rounded-lg hover:bg-orange-700 transition-colors font-semibold">
                                Submit Grade
                            </button>
                        </form>
                    </div>
                    
                    <!-- Assignments List -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">All Assignments</h3>
                        <div id="assignmentsList" class="space-y-4">
                            <!-- Assignments will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Attendance Tab -->
                <div id="content-attendance" class="tab-content hidden">
                    <!-- Mark Attendance -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Mark Attendance</h3>
                        <form onsubmit="markAttendance(event)" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <select id="attendanceStudentId" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="">Select Student</option>
                            </select>
                            <input type="date" id="attendanceDate" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <select id="attendanceStatus" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="present">Present</option>
                                <option value="absent">Absent</option>
                                <option value="late">Late</option>
                                <option value="excused">Excused</option>
                            </select>
                            <button type="submit" class="bg-indigo-600 text-white p-3 rounded-lg hover:bg-indigo-700 transition-colors font-semibold">
                                Mark Attendance
                            </button>
                        </form>
                    </div>
                    
                    <!-- Attendance Overview -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Attendance Records</h3>
                        <div id="attendanceOverview" class="space-y-4">
                            <!-- Attendance will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Achievements Tab -->
                <div id="content-achievements" class="tab-content hidden">
                    <!-- Add Achievement -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Add Achievement</h3>
                        <form onsubmit="addAchievement(event)" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                            <select id="achievementStudentId" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="">Select Student</option>
                            </select>
                            <input type="text" id="achievementTitle" placeholder="Achievement Title" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <select id="achievementCategory" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                                <option value="">Select Category</option>
                                <option value="academic">Academic</option>
                                <option value="sports">Sports</option>
                                <option value="arts">Arts</option>
                                <option value="leadership">Leadership</option>
                                <option value="community">Community Service</option>
                            </select>
                            <input type="date" id="achievementDate" required class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-600 dark:text-white text-base">
                            <button type="submit" class="bg-yellow-600 text-white p-3 rounded-lg hover:bg-yellow-700 transition-colors font-semibold">
                                Add Achievement
                            </button>
                        </form>
                    </div>
                    
                    <!-- Achievements List -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">All Achievements</h3>
                        <div id="achievementsList" class="space-y-4">
                            <!-- Achievements will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Student Dashboard -->
        <div id="studentDashboard" class="hidden w-full max-w-7xl">
            <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 card-shadow">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800 dark:text-white">Student Dashboard</h1>
                        <p class="text-gray-600 dark:text-gray-300 font-lato" id="studentWelcome">Welcome back!</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-right">
                            <p class="text-sm text-gray-600 dark:text-gray-400" id="studentInfo">Loading...</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400" id="studentClass">Class Info</p>
                        </div>
                        <button onclick="logout()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            Logout
                        </button>
                    </div>
                </div>
                
                <!-- Student Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-blue-50 dark:bg-blue-900 p-6 rounded-lg transform hover:scale-105 transition-transform">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold text-blue-800 dark:text-blue-200 mb-2">Overall GPA</h3>
                                <p class="text-3xl font-bold text-blue-600" id="studentGPA">0.0</p>
                            </div>
                            <i data-lucide="trending-up" class="w-8 h-8 text-blue-500"></i>
                        </div>
                        <div class="mt-3">
                            <div class="bg-blue-200 dark:bg-blue-800 rounded-full h-2">
                                <div class="progress-bar" id="gpaProgress" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900 p-6 rounded-lg transform hover:scale-105 transition-transform">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold text-green-800 dark:text-green-200 mb-2">Attendance</h3>
                                <p class="text-3xl font-bold text-green-600" id="studentAttendance">0%</p>
                            </div>
                            <i data-lucide="calendar-check" class="w-8 h-8 text-green-500"></i>
                        </div>
                        <div class="mt-3">
                            <div class="bg-green-200 dark:bg-green-800 rounded-full h-2">
                                <div class="progress-bar bg-green-500" id="attendanceProgress" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-yellow-50 dark:bg-yellow-900 p-6 rounded-lg transform hover:scale-105 transition-transform">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold text-yellow-800 dark:text-yellow-200 mb-2">Assignments</h3>
                                <p class="text-3xl font-bold text-yellow-600" id="studentAssignments">0/0</p>
                            </div>
                            <i data-lucide="clipboard-list" class="w-8 h-8 text-yellow-500"></i>
                        </div>
                        <div class="mt-3">
                            <div class="bg-yellow-200 dark:bg-yellow-800 rounded-full h-2">
                                <div class="progress-bar bg-yellow-500" id="assignmentProgress" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-purple-50 dark:bg-purple-900 p-6 rounded-lg transform hover:scale-105 transition-transform">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="font-semibold text-purple-800 dark:text-purple-200 mb-2">Class Rank</h3>
                                <p class="text-3xl font-bold text-purple-600" id="studentRank">#-</p>
                            </div>
                            <i data-lucide="trophy" class="w-8 h-8 text-purple-500"></i>
                        </div>
                        <div class="mt-3 text-sm text-purple-600 dark:text-purple-300" id="rankStatus">
                            Calculating...
                        </div>
                    </div>
                </div>
                
                <!-- Student Dashboard Tabs -->
                <div class="flex flex-wrap gap-2 mb-8 border-b border-gray-200 dark:border-gray-600">
                    <button onclick="switchStudentTab('overview')" id="student-tab-overview" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-active">
                        Overview
                    </button>
                    <button onclick="switchStudentTab('grades')" id="student-tab-grades" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-inactive">
                        My Grades
                    </button>
                    <button onclick="switchStudentTab('assignments')" id="student-tab-assignments" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-inactive">
                        Assignments
                    </button>
                    <button onclick="switchStudentTab('achievements')" id="student-tab-achievements" class="px-6 py-3 rounded-t-lg font-semibold transition-all duration-300 tab-inactive">
                        Achievements
                    </button>
                </div>

                <!-- Overview Tab -->
                <div id="student-content-overview" class="student-tab-content">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                        <!-- Recent Grades -->
                        <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                            <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                                <i data-lucide="bar-chart-3" class="w-5 h-5 mr-2"></i>
                                Recent Grades
                            </h3>
                            <div class="space-y-4" id="studentRecentGrades">
                                <!-- Grades will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Upcoming Assignments -->
                        <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                            <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                                <i data-lucide="calendar-clock" class="w-5 h-5 mr-2"></i>
                                Upcoming Assignments
                            </h3>
                            <div class="space-y-4" id="studentUpcomingAssignments">
                                <!-- Assignments will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Achievements and Attendance -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- Recent Achievements -->
                        <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                            <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                                <i data-lucide="award" class="w-5 h-5 mr-2"></i>
                                Recent Achievements
                            </h3>
                            <div class="space-y-4" id="studentAchievements">
                                <!-- Achievements will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Attendance Overview -->
                        <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                            <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                                <i data-lucide="calendar-days" class="w-5 h-5 mr-2"></i>
                                Attendance Overview
                            </h3>
                            <div id="studentAttendanceChart">
                                <!-- Attendance chart will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grades Tab -->
                <div id="student-content-grades" class="student-tab-content hidden">
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">All Subject Grades</h3>
                        <div id="studentAllGrades" class="space-y-4">
                            <!-- All grades will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Assignments Tab -->
                <div id="student-content-assignments" class="student-tab-content hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- Pending Assignments -->
                        <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                            <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Pending Assignments</h3>
                            <div id="studentPendingAssignments" class="space-y-4">
                                <!-- Pending assignments will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Completed Assignments -->
                        <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                            <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Completed Assignments</h3>
                            <div id="studentCompletedAssignments" class="space-y-4">
                                <!-- Completed assignments will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Achievements Tab -->
                <div id="student-content-achievements" class="student-tab-content hidden">
                    <div class="bg-gray-50 dark:bg-gray-700 p-6 rounded-lg">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">All Achievements</h3>
                        <div id="studentAllAchievements" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- All achievements will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Global variables
        let currentStudent = null;
        let currentTab = 'students';
        let currentStudentTab = 'overview';
        
        // Initialize data storage
        function initializeStorage() {
            if (!localStorage.getItem('eliteAcademy_students')) {
                const sampleStudents = [
                    {
                        id: 'EA001',
                        name: 'John Smith',
                        email: 'john.smith@student.ea.edu',
                        class: 'Grade 10A',
                        accessCode: 'JS2024',
                        gpa: 3.85,
                        attendance: 94,
                        rank: 2,
                        grades: [
                            { subject: 'Mathematics', grade: 'A-', points: 88, date: '2024-01-15' },
                            { subject: 'English', grade: 'B+', points: 85, date: '2024-01-12' },
                            { subject: 'Science', grade: 'A', points: 92, date: '2024-01-10' },
                            { subject: 'History', grade: 'B', points: 82, date: '2024-01-08' },
                            { subject: 'Physical Education', grade: 'A', points: 95, date: '2024-01-05' }
                        ],
                        assignments: [
                            { id: 'ASG001', title: 'Math Quiz 3', subject: 'Mathematics', due: '2024-01-25', status: 'pending', score: null, maxPoints: 100 },
                            { id: 'ASG002', title: 'English Essay', subject: 'English', due: '2024-01-22', status: 'completed', score: 85, maxPoints: 100 },
                            { id: 'ASG005', title: 'Science Lab Report', subject: 'Science', due: '2024-01-28', status: 'pending', score: null, maxPoints: 100 }
                        ],
                        achievements: [
                            { title: 'Science Fair Winner', category: 'academic', date: '2024-01-05' },
                            { title: 'Perfect Attendance Award', category: 'academic', date: '2024-01-01' },
                            { title: 'Basketball Team Captain', category: 'sports', date: '2023-12-15' }
                        ],
                        attendanceRecords: [
                            { date: '2024-01-15', status: 'present' },
                            { date: '2024-01-14', status: 'present' },
                            { date: '2024-01-13', status: 'late' },
                            { date: '2024-01-12', status: 'present' },
                            { date: '2024-01-11', status: 'present' },
                            { date: '2024-01-10', status: 'present' },
                            { date: '2024-01-09', status: 'absent' },
                            { date: '2024-01-08', status: 'present' }
                        ]
                    },
                    {
                        id: 'EA002',
                        name: 'Sarah Johnson',
                        email: 'sarah.johnson@student.ea.edu',
                        class: 'Grade 11B',
                        accessCode: 'SJ2024',
                        gpa: 4.0,
                        attendance: 98,
                        rank: 1,
                        grades: [
                            { subject: 'Chemistry', grade: 'A+', points: 97, date: '2024-01-14' },
                            { subject: 'Physics', grade: 'A', points: 94, date: '2024-01-11' },
                            { subject: 'Biology', grade: 'A', points: 91, date: '2024-01-09' },
                            { subject: 'Mathematics', grade: 'A+', points: 98, date: '2024-01-07' },
                            { subject: 'English', grade: 'A', points: 93, date: '2024-01-06' }
                        ],
                        assignments: [
                            { id: 'ASG003', title: 'Chemistry Lab Report', subject: 'Chemistry', due: '2024-01-21', status: 'completed', score: 97, maxPoints: 100 },
                            { id: 'ASG004', title: 'Physics Problem Set', subject: 'Physics', due: '2024-01-23', status: 'pending', score: null, maxPoints: 100 },
                            { id: 'ASG006', title: 'Biology Research Paper', subject: 'Biology', due: '2024-01-30', status: 'pending', score: null, maxPoints: 100 }
                        ],
                        achievements: [
                            { title: 'Valedictorian Candidate', category: 'academic', date: '2024-01-10' },
                            { title: 'Chemistry Olympiad Gold', category: 'academic', date: '2024-01-03' },
                            { title: 'Student Council President', category: 'leadership', date: '2023-09-01' }
                        ],
                        attendanceRecords: [
                            { date: '2024-01-15', status: 'present' },
                            { date: '2024-01-14', status: 'present' },
                            { date: '2024-01-13', status: 'present' },
                            { date: '2024-01-12', status: 'present' },
                            { date: '2024-01-11', status: 'present' },
                            { date: '2024-01-10', status: 'present' },
                            { date: '2024-01-09', status: 'present' },
                            { date: '2024-01-08', status: 'excused' }
                        ]
                    }
                ];
                localStorage.setItem('eliteAcademy_students', JSON.stringify(sampleStudents));
            }
            
            if (!localStorage.getItem('eliteAcademy_assignments')) {
                const sampleAssignments = [
                    { id: 'ASG001', title: 'Math Quiz 3', subject: 'Mathematics', due: '2024-01-25', maxPoints: 100 },
                    { id: 'ASG002', title: 'English Essay', subject: 'English', due: '2024-01-22', maxPoints: 100 },
                    { id: 'ASG003', title: 'Chemistry Lab Report', subject: 'Chemistry', due: '2024-01-21', maxPoints: 100 },
                    { id: 'ASG004', title: 'Physics Problem Set', subject: 'Physics', due: '2024-01-23', maxPoints: 100 },
                    { id: 'ASG005', title: 'Science Lab Report', subject: 'Science', due: '2024-01-28', maxPoints: 100 },
                    { id: 'ASG006', title: 'Biology Research Paper', subject: 'Biology', due: '2024-01-30', maxPoints: 100 }
                ];
                localStorage.setItem('eliteAcademy_assignments', JSON.stringify(sampleAssignments));
            }
            
            if (!localStorage.getItem('eliteAcademy_parents')) {
                const sampleParents = [
                    {
                        email: 'parent1@example.com',
                        password: 'parent123',
                        childId: 'EA001'
                    }
                ];
                localStorage.setItem('eliteAcademy_parents', JSON.stringify(sampleParents));
            }
        }
        
        // Admin credentials
        const ADMIN_EMAIL = 'ayubj8753@gmail.com';
        const ADMIN_PASSWORD = 'EliteAdmin2024!';
        const ADMIN_CODE = 'EA-ADMIN-2024';
        
        // Initialize app
        initializeStorage();
        
        // Dark mode functionality
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
        }
        
        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        // Listen for system dark mode changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (!localStorage.getItem('darkMode')) {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }
        });
        
        // Accessibility functions
        function toggleAccessibility() {
            const panel = document.getElementById('accessibilityPanel');
            panel.classList.toggle('hidden');
        }
        
        function changeTextSize(size) {
            const body = document.body;
            body.classList.remove('text-enlarge-sm', 'text-enlarge-md', 'text-enlarge-lg');
            if (size !== 'normal') {
                body.classList.add(`text-enlarge-${size}`);
            }
            localStorage.setItem('textSize', size);
        }
        
        // Load saved text size
        const savedTextSize = localStorage.getItem('textSize');
        if (savedTextSize && savedTextSize !== 'normal') {
            changeTextSize(savedTextSize);
        }
        
        // AI Assistant functionality
        function toggleAI() {
            const aiChat = document.getElementById('aiChat');
            aiChat.classList.toggle('hidden');
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const messages = document.getElementById('chatMessages');
            
            if (input.value.trim()) {
                // Add user message
                const userMsg = document.createElement('div');
                userMsg.className = 'bg-gray-100 dark:bg-gray-600 p-2 rounded ml-8 text-right';
                userMsg.textContent = input.value;
                messages.appendChild(userMsg);
                
                // Add AI response
                setTimeout(() => {
                    const aiMsg = document.createElement('div');
                    aiMsg.className = 'bg-blue-100 dark:bg-blue-900 p-2 rounded';
                    aiMsg.textContent = getAIResponse(input.value);
                    messages.appendChild(aiMsg);
                    messages.scrollTop = messages.scrollHeight;
                }, 1000);
                
                input.value = '';
                messages.scrollTop = messages.scrollHeight;
            }
        }
        
        function getAIResponse(message) {
            const responses = [
                "I can help you navigate the portal. What specific information are you looking for?",
                "For login issues, please check your credentials or contact the admin.",
                "You can access your grades, assignments, and attendance from the student dashboard.",
                "If you need technical support, I'm here to guide you through the process.",
                "For academic inquiries, you can contact your teachers through the portal.",
                "To check your GPA and class rank, visit the student dashboard main page.",
                "Attendance records are updated daily by your teachers.",
                "Achievement awards are added by administrators when you reach milestones.",
                "Your assignments are organized by pending and completed status for easy tracking."
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        // Navigation functions
        function showLogin(type) {
            document.getElementById('portalSelection').classList.add('hidden');
            document.getElementById(`${type}Login`).classList.remove('hidden');
        }
        
        function goBack() {
            // Hide all login forms and dashboards
            const forms = ['adminLogin', 'studentLogin', 'parentLogin', 'adminDashboard', 'studentDashboard'];
            forms.forEach(form => {
                document.getElementById(form).classList.add('hidden');
            });
            
            // Show portal selection
            document.getElementById('portalSelection').classList.remove('hidden');
        }
        
        function logout() {
            sessionStorage.clear();
            currentStudent = null;
            goBack();
        }
        
        // Tab switching functionality for admin
        function switchTab(tabName) {
            // Update tab buttons
            const tabs = ['students', 'grades', 'assignments', 'attendance', 'achievements'];
            tabs.forEach(tab => {
                const button = document.getElementById(`tab-${tab}`);
                const content = document.getElementById(`content-${tab}`);
                
                if (tab === tabName) {
                    button.className = button.className.replace('tab-inactive', 'tab-active');
                    content.classList.remove('hidden');
                } else {
                    button.className = button.className.replace('tab-active', 'tab-inactive');
                    content.classList.add('hidden');
                }
            });
            
            currentTab = tabName;
            
            // Load tab-specific data
            switch(tabName) {
                case 'students':
                    loadAdminDashboard();
                    break;
                case 'grades':
                    loadGradesTab();
                    break;
                case 'assignments':
                    loadAssignmentsTab();
                    break;
                case 'attendance':
                    loadAttendanceTab();
                    break;
                case 'achievements':
                    loadAchievementsTab();
                    break;
            }
        }
        
        // Tab switching functionality for student
        function switchStudentTab(tabName) {
            // Update tab buttons
            const tabs = ['overview', 'grades', 'assignments', 'achievements'];
            tabs.forEach(tab => {
                const button = document.getElementById(`student-tab-${tab}`);
                const content = document.getElementById(`student-content-${tab}`);
                
                if (tab === tabName) {
                    button.className = button.className.replace('tab-inactive', 'tab-active');
                    content.classList.remove('hidden');
                } else {
                    button.className = button.className.replace('tab-active', 'tab-inactive');
                    content.classList.add('hidden');
                }
            });
            
            currentStudentTab = tabName;
            
            // Load tab-specific data
            if (currentStudent) {
                switch(tabName) {
                    case 'overview':
                        loadStudentOverview(currentStudent);
                        break;
                    case 'grades':
                        loadStudentAllGrades(currentStudent);
                        break;
                    case 'assignments':
                        loadStudentAllAssignments(currentStudent);
                        break;
                    case 'achievements':
                        loadStudentAllAchievements(currentStudent);
                        break;
                }
            }
        }
        
        // Login functions
        function adminLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            const code = document.getElementById('adminCode').value;
            
            if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD && code === ADMIN_CODE) {
                sessionStorage.setItem('userType', 'admin');
                sessionStorage.setItem('userEmail', email);
                
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                
                loadAdminDashboard();
            } else {
                showCustomAlert('Invalid credentials. Please check your email, password, and security code.');
            }
        }
        
        function studentLogin(event) {
            event.preventDefault();
            
            const studentId = document.getElementById('studentId').value;
            const accessCode = document.getElementById('studentCode').value;
            
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const student = students.find(s => s.id === studentId && s.accessCode === accessCode);
            
            if (student) {
                sessionStorage.setItem('userType', 'student');
                sessionStorage.setItem('studentId', studentId);
                sessionStorage.setItem('studentData', JSON.stringify(student));
                currentStudent = student;
                
                document.getElementById('studentLogin').classList.add('hidden');
                document.getElementById('studentDashboard').classList.remove('hidden');
                
                loadStudentDashboard(student);
            } else {
                showCustomAlert('Invalid student ID or access code. Please check your credentials and try again.');
            }
        }
        
        function parentLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('parentEmail').value;
            const password = document.getElementById('parentPassword').value;
            const childId = document.getElementById('childId').value;
            
            const parents = JSON.parse(localStorage.getItem('eliteAcademy_parents'));
            const parent = parents.find(p => p.email === email && p.password === password && p.childId === childId);
            
            if (parent) {
                sessionStorage.setItem('userType', 'parent');
                sessionStorage.setItem('parentEmail', email);
                sessionStorage.setItem('childId', childId);
                
                showCustomAlert('Parent dashboard coming soon! This feature is under development.');
            } else {
                showCustomAlert('Invalid parent credentials or child ID. Please check your information.');
            }
        }
        
        // Admin Dashboard Functions
        function loadAdminDashboard() {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const assignments = JSON.parse(localStorage.getItem('eliteAcademy_assignments')) || [];
            
            // Update statistics
            document.getElementById('totalStudents').textContent = students.length;
            
            const totalGPA = students.reduce((sum, student) => sum + student.gpa, 0);
            const averageGPA = students.length > 0 ? (totalGPA / students.length).toFixed(2) : '0.0';
            document.getElementById('averageGPA').textContent = averageGPA;
            
            document.getElementById('activeAssignments').textContent = assignments.length;
            
            const subjects = new Set();
            students.forEach(student => {
                student.grades.forEach(grade => subjects.add(grade.subject));
            });
            document.getElementById('totalSubjects').textContent = subjects.size;
            
            // Load students table
            loadStudentsTable();
            
            // Load dropdown options
            loadStudentDropdowns();
        }
        
        function loadStudentsTable() {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const tableBody = document.getElementById('studentsTable');
            tableBody.innerHTML = '';
            
            // Sort students by rank
            students.sort((a, b) => (a.rank || 999) - (b.rank || 999));
            
            students.forEach(student => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600';
                row.innerHTML = `
                    <td class="p-3 text-gray-700 dark:text-gray-300 font-mono">${student.id}</td>
                    <td class="p-3 text-gray-700 dark:text-gray-300">${student.name}</td>
                    <td class="p-3 text-gray-700 dark:text-gray-300">${student.email}</td>
                    <td class="p-3 text-gray-700 dark:text-gray-300">${student.class}</td>
                    <td class="p-3 text-gray-700 dark:text-gray-300 font-bold">${student.gpa.toFixed(2)}</td>
                    <td class="p-3 text-gray-700 dark:text-gray-300">#${student.rank || '-'}</td>
                    <td class="p-3">
                        <button onclick="editStudent('${student.id}')" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 mr-2">Edit</button>
                        <button onclick="deleteStudent('${student.id}')" class="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700">Delete</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        function loadStudentDropdowns() {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const dropdowns = ['gradeStudentId', 'assignmentStudentId', 'attendanceStudentId', 'achievementStudentId'];
            
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    dropdown.innerHTML = '<option value="">Select Student</option>';
                    students.forEach(student => {
                        const option = document.createElement('option');
                        option.value = student.id;
                        option.textContent = `${student.name} (${student.id})`;
                        dropdown.appendChild(option);
                    });
                }
            });
        }
        
        function loadGradesTab() {
            loadStudentDropdowns();
            loadGradesOverview();
        }
        
        function loadGradesOverview() {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const container = document.getElementById('gradesOverview');
            container.innerHTML = '';
            
            let allGrades = [];
            students.forEach(student => {
                student.grades.forEach(grade => {
                    allGrades.push({
                        ...grade,
                        studentName: student.name,
                        studentId: student.id
                    });
                });
            });
            
            // Sort by date (newest first)
            allGrades.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            allGrades.slice(0, 10).forEach(grade => {
                const gradeElement = document.createElement('div');
                gradeElement.className = 'flex justify-between items-center p-4 bg-white dark:bg-gray-600 rounded border-l-4 border-blue-500';
                gradeElement.innerHTML = `
                    <div>
                        <h4 class="font-semibold text-gray-800 dark:text-white">${grade.studentName}</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">${grade.subject} - ${grade.date}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-lg font-bold ${getGradeColorClass(grade.grade)}">${grade.grade}</p>
                        <p class="text-sm text-gray-600 dark:text-gray-300">${grade.points}/100</p>
                    </div>
                `;
                container.appendChild(gradeElement);
            });
        }
        
        function loadAssignmentsTab() {
            loadStudentDropdowns();
            loadAssignmentDropdown();
            loadAssignmentsList();
        }
        
        function loadAssignmentDropdown() {
            const assignments = JSON.parse(localStorage.getItem('eliteAcademy_assignments')) || [];
            const dropdown = document.getElementById('assignmentSelect');
            if (dropdown) {
                dropdown.innerHTML = '<option value="">Select Assignment</option>';
                assignments.forEach(assignment => {
                    const option = document.createElement('option');
                    option.value = assignment.id;
                    option.textContent = `${assignment.title} (${assignment.subject})`;
                    dropdown.appendChild(option);
                });
            }
        }
        
        function loadAssignmentsList() {
            const assignments = JSON.parse(localStorage.getItem('eliteAcademy_assignments')) || [];
            const container = document.getElementById('assignmentsList');
            container.innerHTML = '';
            
            assignments.forEach(assignment => {
                const assignmentElement = document.createElement('div');
                assignmentElement.className = 'p-4 bg-white dark:bg-gray-600 rounded border-l-4 border-purple-500';
                assignmentElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold text-gray-800 dark:text-white">${assignment.title}</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-300">${assignment.subject} - Due: ${assignment.due}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-bold text-purple-600">${assignment.maxPoints} pts</p>
                            <button onclick="deleteAssignment('${assignment.id}')" class="text-red-600 hover:text-red-800 text-sm">Delete</button>
                        </div>
                    </div>
                `;
                container.appendChild(assignmentElement);
            });
        }
        
        function loadAttendanceTab() {
            loadStudentDropdowns();
            loadAttendanceOverview();
            
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
        }
        
        function loadAttendanceOverview() {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const container = document.getElementById('attendanceOverview');
            container.innerHTML = '';
            
            students.forEach(student => {
                const presentDays = student.attendanceRecords ? student.attendanceRecords.filter(record => record.status === 'present').length : 0;
                const totalDays = student.attendanceRecords ? student.attendanceRecords.length : 0;
                const attendancePercentage = totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 0;
                
                const attendanceElement = document.createElement('div');
                attendanceElement.className = 'p-4 bg-white dark:bg-gray-600 rounded border-l-4 border-indigo-500';
                attendanceElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold text-gray-800 dark:text-white">${student.name}</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-300">${student.class}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-bold text-indigo-600">${attendancePercentage}%</p>
                            <p class="text-sm text-gray-600 dark:text-gray-300">${presentDays}/${totalDays} days</p>
                        </div>
                    </div>
                `;
                container.appendChild(attendanceElement);
            });
        }
        
        function loadAchievementsTab() {
            loadStudentDropdowns();
            loadAchievementsList();
        }
        
        function loadAchievementsList() {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const container = document.getElementById('achievementsList');
            container.innerHTML = '';
            
            let allAchievements = [];
            students.forEach(student => {
                if (student.achievements) {
                    student.achievements.forEach(achievement => {
                        allAchievements.push({
                            ...achievement,
                            studentName: student.name,
                            studentId: student.id
                        });
                    });
                }
            });
            
            // Sort by date (newest first)
            allAchievements.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            allAchievements.forEach(achievement => {
                const achievementElement = document.createElement('div');
                achievementElement.className = 'p-4 bg-white dark:bg-gray-600 rounded border-l-4 border-yellow-500';
                achievementElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold text-gray-800 dark:text-white">${achievement.title}</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-300">${achievement.studentName} - ${achievement.date}</p>
                        </div>
                        <div class="text-right">
                            <span class="px-2 py-1 rounded text-sm ${getCategoryColor(achievement.category)}">${achievement.category}</span>
                        </div>
                    </div>
                `;
                container.appendChild(achievementElement);
            });
        }
        
        // Student Dashboard Functions
        function loadStudentDashboard(student) {
            document.getElementById('studentWelcome').textContent = `Welcome back, ${student.name}!`;
            document.getElementById('studentInfo').textContent = `Student ID: ${student.id}`;
            document.getElementById('studentClass').textContent = `Class: ${student.class}`;
            
            // Update main stats
            document.getElementById('studentGPA').textContent = student.gpa.toFixed(2);
            document.getElementById('studentAttendance').textContent = `${student.attendance}%`;
            
            const completedAssignments = student.assignments ? student.assignments.filter(a => a.status === 'completed').length : 0;
            const totalAssignments = student.assignments ? student.assignments.length : 0;
            document.getElementById('studentAssignments').textContent = `${completedAssignments}/${totalAssignments}`;
            document.getElementById('studentRank').textContent = `#${student.rank || '-'}`;
            
            // Update progress bars
            const gpaPercentage = (student.gpa / 4.0) * 100;
            document.getElementById('gpaProgress').style.width = `${gpaPercentage}%`;
            document.getElementById('attendanceProgress').style.width = `${student.attendance}%`;
            
            const assignmentPercentage = totalAssignments > 0 ? (completedAssignments / totalAssignments) * 100 : 0;
            document.getElementById('assignmentProgress').style.width = `${assignmentPercentage}%`;
            
            // Update rank status
            const rankStatus = document.getElementById('rankStatus');
            if (student.rank === 1) {
                rankStatus.textContent = 'Top of Class!';
            } else if (student.rank <= 5) {
                rankStatus.textContent = 'Top 5';
            } else if (student.rank <= 10) {
                rankStatus.textContent = 'Top 10';
            } else {
                rankStatus.textContent = 'Keep improving!';
            }
            
            // Load overview content
            loadStudentOverview(student);
        }
        
        function loadStudentOverview(student) {
            loadStudentGrades(student);
            loadStudentAssignments(student);
            loadStudentAchievements(student);
            loadStudentAttendanceChart(student);
        }
        
        function loadStudentGrades(student) {
            const container = document.getElementById('studentRecentGrades');
            container.innerHTML = '';
            
            if (!student.grades || student.grades.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No grades available yet.</p>';
                return;
            }
            
            // Sort grades by date (newest first)
            const sortedGrades = [...student.grades].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedGrades.slice(0, 5).forEach(grade => {
                const gradeElement = document.createElement('div');
                gradeElement.className = 'flex justify-between items-center p-3 bg-white dark:bg-gray-600 rounded hover:scale-105 transition-transform';
                gradeElement.innerHTML = `
                    <div>
                        <h4 class="font-semibold text-gray-800 dark:text-white">${grade.subject}</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">${grade.date}</p>
                    </div>
                    <div class="text-right">
                        <span class="text-lg font-bold ${getGradeColorClass(grade.grade)}">${grade.grade}</span>
                        <p class="text-sm text-gray-600 dark:text-gray-300">${grade.points}/100</p>
                    </div>
                `;
                container.appendChild(gradeElement);
            });
        }
        
        function loadStudentAssignments(student) {
            const container = document.getElementById('studentUpcomingAssignments');
            container.innerHTML = '';
            
            if (!student.assignments || student.assignments.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No assignments available yet.</p>';
                return;
            }
            
            // Filter and sort upcoming assignments
            const upcomingAssignments = student.assignments
                .filter(a => a.status === 'pending' || new Date(a.due) >= new Date())
                .sort((a, b) => new Date(a.due) - new Date(b.due));
            
            if (upcomingAssignments.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No upcoming assignments.</p>';
                return;
            }
            
            upcomingAssignments.slice(0, 5).forEach(assignment => {
                const assignmentElement = document.createElement('div');
                assignmentElement.className = 'flex justify-between items-center p-3 bg-white dark:bg-gray-600 rounded hover:scale-105 transition-transform';
                const isOverdue = new Date(assignment.due) < new Date() && assignment.status === 'pending';
                assignmentElement.innerHTML = `
                    <div>
                        <h4 class="font-semibold text-gray-800 dark:text-white">${assignment.title}</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300">${assignment.subject} - Due: ${assignment.due}</p>
                        ${isOverdue ? '<p class="text-xs text-red-500 font-medium">OVERDUE</p>' : ''}
                    </div>
                    <span class="px-2 py-1 rounded text-sm ${getStatusColor(assignment.status)}">${assignment.status}</span>
                `;
                container.appendChild(assignmentElement);
            });
        }
        
        function loadStudentAchievements(student) {
            const container = document.getElementById('studentAchievements');
            container.innerHTML = '';
            
            if (!student.achievements || student.achievements.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No achievements yet. Keep working hard!</p>';
                return;
            }
            
            // Sort achievements by date (newest first)
            const sortedAchievements = [...student.achievements].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedAchievements.slice(0, 3).forEach(achievement => {
                const achievementElement = document.createElement('div');
                achievementElement.className = 'flex justify-between items-center p-3 bg-white dark:bg-gray-600 rounded hover:scale-105 transition-transform';
                achievementElement.innerHTML = `
                    <div class="flex items-center">
                        <i data-lucide="trophy" class="w-5 h-5 text-yellow-500 mr-3"></i>
                        <div>
                            <h4 class="font-semibold text-gray-800 dark:text-white">${achievement.title}</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-300">${achievement.date}</p>
                        </div>
                    </div>
                    <span class="px-2 py-1 rounded text-sm ${getCategoryColor(achievement.category)}">${achievement.category}</span>
                `;
                container.appendChild(achievementElement);
            });
            
            // Re-initialize lucide icons
            lucide.createIcons();
        }
        
        function loadStudentAttendanceChart(student) {
            const container = document.getElementById('studentAttendanceChart');
            container.innerHTML = '';
            
            if (!student.attendanceRecords || student.attendanceRecords.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No attendance records available yet.</p>';
                return;
            }
            
            // Create simple attendance visualization
            const presentDays = student.attendanceRecords.filter(r => r.status === 'present').length;
            const lateDays = student.attendanceRecords.filter(r => r.status === 'late').length;
            const absentDays = student.attendanceRecords.filter(r => r.status === 'absent').length;
            const excusedDays = student.attendanceRecords.filter(r => r.status === 'excused').length;
            
            const chartElement = document.createElement('div');
            chartElement.className = 'space-y-3';
            chartElement.innerHTML = `
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600 dark:text-gray-300 flex items-center">
                        <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                        Present
                    </span>
                    <span class="text-sm font-semibold text-green-600">${presentDays} days</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600 dark:text-gray-300 flex items-center">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></div>
                        Late
                    </span>
                    <span class="text-sm font-semibold text-yellow-600">${lateDays} days</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600 dark:text-gray-300 flex items-center">
                        <div class="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                        Absent
                    </span>
                    <span class="text-sm font-semibold text-red-600">${absentDays} days</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-sm text-gray-600 dark:text-gray-300 flex items-center">
                        <div class="w-3 h-3 bg-blue-500 rounded-full mr-2"></div>
                        Excused
                    </span>
                    <span class="text-sm font-semibold text-blue-600">${excusedDays} days</span>
                </div>
                <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-600">
                    <div class="flex justify-between items-center">
                        <span class="text-sm font-semibold text-gray-800 dark:text-white">Overall Rate</span>
                        <span class="text-lg font-bold text-green-600">${student.attendance}%</span>
                    </div>
                </div>
            `;
            container.appendChild(chartElement);
        }
        
        function loadStudentAllGrades(student) {
            const container = document.getElementById('studentAllGrades');
            container.innerHTML = '';
            
            if (!student.grades || student.grades.length === 0) {
                container.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No grades available yet.</p>';
                return;
            }
            
            // Group grades by subject
            const gradesBySubject = {};
            student.grades.forEach(grade => {
                if (!gradesBySubject[grade.subject]) {
                    gradesBySubject[grade.subject] = [];
                }
                gradesBySubject[grade.subject].push(grade);
            });
            
            Object.keys(gradesBySubject).forEach(subject => {
                const subjectGrades = gradesBySubject[subject].sort((a, b) => new Date(b.date) - new Date(a.date));
                const avgPoints = subjectGrades.reduce((sum, grade) => sum + grade.points, 0) / subjectGrades.length;
                
                const subjectElement = document.createElement('div');
                subjectElement.className = 'p-4 bg-white dark:bg-gray-600 rounded border-l-4 border-blue-500';
                subjectElement.innerHTML = `
                    <div class="flex justify-between items-center mb-3">
                        <h4 class="text-lg font-semibold text-gray-800 dark:text-white">${subject}</h4>
                        <span class="text-lg font-bold ${getGradeColorClass(subjectGrades[0].grade)}">
                            Latest: ${subjectGrades[0].grade} (${avgPoints.toFixed(1)} avg)
                        </span>
                    </div>
                    <div class="space-y-2">
                        ${subjectGrades.map(grade => `
                            <div class="flex justify-between items-center text-sm">
                                <span class="text-gray-600 dark:text-gray-300">${grade.date}</span>
                                <span class="${getGradeColorClass(grade.grade)}">${grade.grade} (${grade.points}/100)</span>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(subjectElement);
            });
        }
        
        function loadStudentAllAssignments(student) {
            const pendingContainer = document.getElementById('studentPendingAssignments');
            const completedContainer = document.getElementById('studentCompletedAssignments');
            
            pendingContainer.innerHTML = '';
            completedContainer.innerHTML = '';
            
            if (!student.assignments || student.assignments.length === 0) {
                pendingContainer.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No assignments available yet.</p>';
                completedContainer.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No completed assignments yet.</p>';
                return;
            }
            
            const pendingAssignments = student.assignments.filter(a => a.status === 'pending').sort((a, b) => new Date(a.due) - new Date(b.due));
            const completedAssignments = student.assignments.filter(a => a.status === 'completed').sort((a, b) => new Date(b.due) - new Date(a.due));
            
            // Load pending assignments
            if (pendingAssignments.length === 0) {
                pendingContainer.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No pending assignments.</p>';
            } else {
                pendingAssignments.forEach(assignment => {
                    const isOverdue = new Date(assignment.due) < new Date();
                    const assignmentElement = document.createElement('div');
                    assignmentElement.className = `p-4 bg-white dark:bg-gray-600 rounded border-l-4 ${isOverdue ? 'border-red-500' : 'border-yellow-500'}`;
                    assignmentElement.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold text-gray-800 dark:text-white">${assignment.title}</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300">${assignment.subject}</p>
                                <p class="text-sm ${isOverdue ? 'text-red-500 font-medium' : 'text-gray-600 dark:text-gray-300'}">
                                    Due: ${assignment.due} ${isOverdue ? '(OVERDUE)' : ''}
                                </p>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold text-gray-700 dark:text-gray-300">${assignment.maxPoints} pts</p>
                                <span class="px-2 py-1 rounded text-sm ${isOverdue ? 'bg-red-100 text-red-800' : 'bg-yellow-100 text-yellow-800'}">
                                    ${isOverdue ? 'Overdue' : 'Pending'}
                                </span>
                            </div>
                        </div>
                    `;
                    pendingContainer.appendChild(assignmentElement);
                });
            }
            
            // Load completed assignments
            if (completedAssignments.length === 0) {
                completedContainer.innerHTML = '<p class="text-gray-500 dark:text-gray-400">No completed assignments yet.</p>';
            } else {
                completedAssignments.forEach(assignment => {
                    const percentage = ((assignment.score || 0) / assignment.maxPoints) * 100;
                    const assignmentElement = document.createElement('div');
                    assignmentElement.className = 'p-4 bg-white dark:bg-gray-600 rounded border-l-4 border-green-500';
                    assignmentElement.innerHTML = `
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold text-gray-800 dark:text-white">${assignment.title}</h4>
                                <p class="text-sm text-gray-600 dark:text-gray-300">${assignment.subject}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-300">Submitted: ${assignment.due}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold ${percentage >= 90 ? 'text-green-600' : percentage >= 80 ? 'text-blue-600' : percentage >= 70 ? 'text-yellow-600' : 'text-red-600'}">
                                    ${assignment.score || 0}/${assignment.maxPoints}
                                </p>
                                <p class="text-sm text-gray-600 dark:text-gray-300">${percentage.toFixed(1)}%</p>
                            </div>
                        </div>
                    `;
                    completedContainer.appendChild(assignmentElement);
                });
            }
        }
        
        function loadStudentAllAchievements(student) {
            const container = document.getElementById('studentAllAchievements');
            container.innerHTML = '';
            
            if (!student.achievements || student.achievements.length === 0) {
                container.innerHTML = '<div class="col-span-full"><p class="text-gray-500 dark:text-gray-400 text-center">No achievements yet. Keep working hard!</p></div>';
                return;
            }
            
            // Sort achievements by date (newest first)
            const sortedAchievements = [...student.achievements].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedAchievements.forEach(achievement => {
                const achievementElement = document.createElement('div');
                achievementElement.className = 'p-4 bg-white dark:bg-gray-600 rounded border-l-4 border-yellow-500 hover:scale-105 transition-transform';
                achievementElement.innerHTML = `
                    <div class="text-center">
                        <i data-lucide="trophy" class="w-8 h-8 text-yellow-500 mx-auto mb-2"></i>
                        <h4 class="font-semibold text-gray-800 dark:text-white">${achievement.title}</h4>
                        <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">${achievement.date}</p>
                        <span class="inline-block mt-2 px-2 py-1 rounded text-sm ${getCategoryColor(achievement.category)}">${achievement.category}</span>
                    </div>
                `;
                container.appendChild(achievementElement);
            });
            
            // Re-initialize lucide icons
            lucide.createIcons();
        }
        
        // Admin Functions
        function addStudent(event) {
            event.preventDefault();
            
            const name = document.getElementById('newStudentName').value;
            const email = document.getElementById('newStudentEmail').value;
            const studentClass = document.getElementById('newStudentClass').value;
            
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            
            const newStudent = {
                id: generateStudentId(),
                name: name,
                email: email,
                class: studentClass,
                accessCode: generateAccessCode(name),
                gpa: 0.0,
                attendance: 100,
                rank: students.length + 1,
                grades: [],
                assignments: [],
                achievements: [],
                attendanceRecords: []
            };
            
            students.push(newStudent);
            localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
            
            // Clear form
            document.getElementById('newStudentName').value = '';
            document.getElementById('newStudentEmail').value = '';
            document.getElementById('newStudentClass').value = '';
            
            // Reload dashboard
            loadAdminDashboard();
            
            showCustomAlert(`Student added successfully!\nID: ${newStudent.id}\nAccess Code: ${newStudent.accessCode}`);
        }
        
        function addGrade(event) {
            event.preventDefault();
            
            const studentId = document.getElementById('gradeStudentId').value;
            const subject = document.getElementById('gradeSubject').value;
            const grade = document.getElementById('gradeValue').value;
            const points = parseInt(document.getElementById('gradePoints').value);
            
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                const newGrade = {
                    subject: subject,
                    grade: grade,
                    points: points,
                    date: new Date().toISOString().split('T')[0]
                };
                
                student.grades.push(newGrade);
                
                // Recalculate GPA
                student.gpa = calculateGPA(student.grades);
                
                // Update ranks
                updateStudentRanks(students);
                
                localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
                
                // Clear form
                document.getElementById('gradeStudentId').value = '';
                document.getElementById('gradeSubject').value = '';
                document.getElementById('gradeValue').value = '';
                document.getElementById('gradePoints').value = '';
                
                loadGradesOverview();
                showCustomAlert('Grade added successfully!');
            }
        }
        
        function addAssignment(event) {
            event.preventDefault();
            
            const title = document.getElementById('assignmentTitle').value;
            const subject = document.getElementById('assignmentSubject').value;
            const due = document.getElementById('assignmentDue').value;
            const maxPoints = parseInt(document.getElementById('assignmentMaxPoints').value);
            
            const assignments = JSON.parse(localStorage.getItem('eliteAcademy_assignments')) || [];
            
            const newAssignment = {
                id: 'ASG' + (assignments.length + 1).toString().padStart(3, '0'),
                title: title,
                subject: subject,
                due: due,
                maxPoints: maxPoints
            };
            
            assignments.push(newAssignment);
            localStorage.setItem('eliteAcademy_assignments', JSON.stringify(assignments));
            
            // Add to all students
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            students.forEach(student => {
                student.assignments.push({
                    ...newAssignment,
                    status: 'pending',
                    score: null
                });
            });
            localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
            
            // Clear form
            document.getElementById('assignmentTitle').value = '';
            document.getElementById('assignmentSubject').value = '';
            document.getElementById('assignmentDue').value = '';
            document.getElementById('assignmentMaxPoints').value = '';
            
            loadAssignmentsTab();
            showCustomAlert('Assignment created successfully!');
        }
        
        function gradeAssignment(event) {
            event.preventDefault();
            
            const studentId = document.getElementById('assignmentStudentId').value;
            const assignmentId = document.getElementById('assignmentSelect').value;
            const score = parseInt(document.getElementById('assignmentScore').value);
            const status = document.getElementById('assignmentStatus').value;
            
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                const assignment = student.assignments.find(a => a.id === assignmentId);
                if (assignment) {
                    assignment.score = score;
                    assignment.status = status;
                    
                    localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
                    
                    // Clear form
                    document.getElementById('assignmentStudentId').value = '';
                    document.getElementById('assignmentSelect').value = '';
                    document.getElementById('assignmentScore').value = '';
                    document.getElementById('assignmentStatus').value = 'completed';
                    
                    showCustomAlert('Assignment graded successfully!');
                }
            }
        }
        
        function markAttendance(event) {
            event.preventDefault();
            
            const studentId = document.getElementById('attendanceStudentId').value;
            const date = document.getElementById('attendanceDate').value;
            const status = document.getElementById('attendanceStatus').value;
            
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                if (!student.attendanceRecords) {
                    student.attendanceRecords = [];
                }
                
                // Check if attendance for this date already exists
                const existingRecord = student.attendanceRecords.find(r => r.date === date);
                if (existingRecord) {
                    existingRecord.status = status;
                } else {
                    student.attendanceRecords.push({ date: date, status: status });
                }
                
                // Recalculate attendance percentage
                const presentDays = student.attendanceRecords.filter(r => r.status === 'present').length;
                const totalDays = student.attendanceRecords.length;
                student.attendance = totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 100;
                
                localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
                
                // Clear form
                document.getElementById('attendanceStudentId').value = '';
                document.getElementById('attendanceDate').value = new Date().toISOString().split('T')[0];
                document.getElementById('attendanceStatus').value = 'present';
                
                loadAttendanceOverview();
                showCustomAlert('Attendance marked successfully!');
            }
        }
        
        function addAchievement(event) {
            event.preventDefault();
            
            const studentId = document.getElementById('achievementStudentId').value;
            const title = document.getElementById('achievementTitle').value;
            const category = document.getElementById('achievementCategory').value;
            const date = document.getElementById('achievementDate').value;
            
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                if (!student.achievements) {
                    student.achievements = [];
                }
                
                student.achievements.push({
                    title: title,
                    category: category,
                    date: date
                });
                
                localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
                
                // Clear form
                document.getElementById('achievementStudentId').value = '';
                document.getElementById('achievementTitle').value = '';
                document.getElementById('achievementCategory').value = '';
                document.getElementById('achievementDate').value = '';
                
                loadAchievementsList();
                showCustomAlert('Achievement added successfully!');
            }
        }
        
        function editStudent(studentId) {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const student = students.find(s => s.id === studentId);
            
            if (student) {
                const newName = prompt('Enter new name:', student.name);
                const newEmail = prompt('Enter new email:', student.email);
                const newClass = prompt('Enter new class:', student.class);
                const newRank = prompt('Enter new rank:', student.rank);
                
                if (newName && newEmail && newClass) {
                    student.name = newName;
                    student.email = newEmail;
                    student.class = newClass;
                    if (newRank && !isNaN(newRank)) {
                        student.rank = parseInt(newRank);
                    }
                    
                    localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
                    loadStudentsTable();
                    showCustomAlert('Student information updated successfully!');
                }
            }
        }
        
        function deleteStudent(studentId) {
            showConfirmDialog('Are you sure you want to delete this student? This action cannot be undone.', () => {
                const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
                const filteredStudents = students.filter(s => s.id !== studentId);
                localStorage.setItem('eliteAcademy_students', JSON.stringify(filteredStudents));
                loadAdminDashboard();
                showCustomAlert('Student deleted successfully!');
            });
        }
        
        function deleteAssignment(assignmentId) {
            showConfirmDialog('Are you sure you want to delete this assignment?', () => {
                const assignments = JSON.parse(localStorage.getItem('eliteAcademy_assignments')) || [];
                const filteredAssignments = assignments.filter(a => a.id !== assignmentId);
                localStorage.setItem('eliteAcademy_assignments', JSON.stringify(filteredAssignments));
                
                // Remove from all students
                const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
                students.forEach(student => {
                    student.assignments = student.assignments.filter(a => a.id !== assignmentId);
                });
                localStorage.setItem('eliteAcademy_students', JSON.stringify(students));
                
                loadAssignmentsList();
                showCustomAlert('Assignment deleted successfully!');
            });
        }
        
        // Utility Functions
        function calculateGPA(grades) {
            if (!grades || grades.length === 0) return 0.0;
            
            const gradePoints = {
                'A+': 4.0, 'A': 4.0, 'A-': 3.7,
                'B+': 3.3, 'B': 3.0, 'B-': 2.7,
                'C+': 2.3, 'C': 2.0, 'C-': 1.7,
                'D': 1.0, 'F': 0.0
            };
            
            const totalPoints = grades.reduce((sum, grade) => sum + (gradePoints[grade.grade] || 0), 0);
            return (totalPoints / grades.length);
        }
        
        function updateStudentRanks(students) {
            // Sort students by GPA (descending)
            students.sort((a, b) => b.gpa - a.gpa);
            
            // Assign ranks
            students.forEach((student, index) => {
                student.rank = index + 1;
            });
        }
        
        function getGradeColorClass(grade) {
            if (grade.includes('A')) return 'grade-a';
            if (grade.includes('B')) return 'grade-b';
            if (grade.includes('C')) return 'grade-c';
            if (grade.includes('D')) return 'grade-d';
            return 'grade-f';
        }
        
        function getStatusColor(status) {
            switch(status) {
                case 'completed': return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';
                case 'pending': return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';
                case 'late': return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';
                default: return 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200';
            }
        }
        
        function getCategoryColor(category) {
            switch(category) {
                case 'academic': return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';
                case 'sports': return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';
                case 'arts': return 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200';
                case 'leadership': return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';
                case 'community': return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';
                default: return 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200';
            }
        }
        
        function generateStudentId() {
            const students = JSON.parse(localStorage.getItem('eliteAcademy_students'));
            const nextNumber = students.length + 1;
            return `EA${nextNumber.toString().padStart(3, '0')}`;
        }
        
        function generateAccessCode(name) {
            const initials = name.split(' ').map(word => word[0]).join('');
            return `${initials}2024`;
        }
        
        // Custom alert and confirm dialogs
        function showCustomAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4 fade-in">
                    <p class="text-gray-700 dark:text-gray-300 mb-4 whitespace-pre-line">${message}</p>
                    <div class="flex justify-end">
                        <button onclick="this.closest('.fixed').remove()" class="px-4 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded transition-colors">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal-overlay';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4 fade-in">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end space-x-3">
                        <button onclick="this.closest('.fixed').remove()" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors">Cancel</button>
                        <button onclick="this.closest('.fixed').remove(); onConfirm()" class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded transition-colors">Confirm</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // Enter key support for chat
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Initialize icons after content loads
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
        });
    </script>
</body>
</html>